version: "3.7"
services:
    db:
        image: motorway-test-backend
        container_name: motorway-test-backend
        build:
            context: ./src/db
            dockerfile: Dockerfile
        environment:
            - POSTGRES_USER=user
            - POSTGRES_PASSWORD=password
            - POSTGRES_DB=motorway
        ports:
            - 5432:5432
    api:
        image: express-api
        build:
            context: .
            dockerfile: ./src/api/Dockerfile
        environment:
            - DB_NAME=motorway
            - DB_USER=user
            - DB_HOST=db
            - DB_DIALECT=postgres
            - DB_PASSWORD=password
        ports:
            - 3000:3000
        depends_on:
            - db
